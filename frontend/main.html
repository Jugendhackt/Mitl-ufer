<!DOCTYPE = html>
<html>
<head>
  <meta charset="utf-8">
  <link href="css/stylesheet.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <meta charset="utf-8">
</head>
<body>
    <div class="header" id="myHeader">
      <a href="start.html"><img class="items" id="logo" src="img/logo.png"></a>
      <input type="text" id="suche" placeholder="Suche..." onchange="searchChange()">
      <img class="search" src="img/search.png">
    </div>
    <div id="list">
    </div>
    <hr>
    <div id="karte">
    </div>

    <script src="http://twitter.github.com/hogan.js/builds/3.0.1/hogan-3.0.1.js"></script>
    <script type="text/javascript" src="./js/main.js"></script>
    <script>
      window.onload = fetchUsers;

      function test(name, eMail){
        console.log(name);
        var hi = JSON.parse(https://nominatim.openstreetmap.org/?format=json&addressdetails=1&q=bakery+in+berlin+wedding&format=json&limit=1);
        console.log(hi);
        var map1 = Hogan.compile('<iframe width="425" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://www.openstreetmap.org/export/embed.html?bbox=7.551727294921876%2C51.80012302802363%2C9.262847900390627%2C52.39655345757824&amp;layer=mapnik&amp;marker=52.099538201560804%2C8.406188897788525" style="border: 1px solid black"></iframe>')
        var map = map1.render();
        document.getElementById("karte").innerHTML=map;
      }

      function loadingFunction(){
        console.log("j");
      }
      function searchChange(){
        const searchString = document.getElementById("suche").value;
        if(searchString !== ""){
          getSearch(searchString).then(function(response) {
            var template = Hogan.compile('{{#response}}<div onclick="test(\'{{name}}\', \'{{eMail}}\');"><hr> <h2> {{name}} </h2><text class="laufOrt"> {{laufort}} </text> <a href="mailto:{{eMail}}"><div class="fa fa-envelope"></div></a> </br> <img class="stars{{laufniveau}}" src="./img/stars{{laufniveau}}.png"></div>{{/response}}');
            // console.log(template);
            var rendering = template.render({response: response});
            // console.log(rendering);
            document.getElementById("list").innerHTML = rendering;
            // console.log(response[0]);
          });
        }
        else{
          fetchUsers();
        }
      }

      function fetchUsers(){
        // const response = mock();
        usersGetAllGet().then(function(response) {
          var template = Hogan.compile('{{#response}}<div onclick="test(\'{{name}}\', \'{{eMail}}\');"><hr> <h2> {{name}} </h2><text class="laufOrt"> {{laufort}} </text> <a href="mailto:{{eMail}}"><div class="fa fa-envelope"></div></a> </br> <img class="stars{{laufniveau}}" src="./img/stars{{laufniveau}}.png"></div>{{/response}}');
          // console.log(template);
          var rendering = template.render({response: response});
          // console.log(rendering);
          document.getElementById("list").innerHTML = rendering;
          // console.log(response[0]);
        });
      }
      window.onscroll = function() {myFunction()};
      var header = document.getElementById("myHeader");
      var sticky = header.offsetTop;
      function myFunction() {
        if (window.pageYOffset > sticky) {
         header.classList.add("sticky");
        } else {
         header.classList.remove("sticky");
          }
        }
       </script>
       <footer><a class="item" href="./about.html"><button>about</button></a>
       </footer>
</body>
</html>
